{% extends "base.html" %}
{% block crud_container %}

<div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mb-4">
  <div class="h3 mb-3 mb-md-0">üìö {{ library.name }}</div>

  <div class="d-flex flex-wrap gap-2 ">
    {% if library.owner_id == user.id %}
      <button type="button" class="btn btn-outline-danger"
              onclick="confirmDeleteLibrary({{ library.id }}, '{{ library.name }}')">
            üóë –£–¥–∞–ª–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É
      </button>

    {% else %}
      <button type="button" class="btn btn-outline-warning"
              onclick="confirmLeaveLibrary({{ library.id }}, '{{ library.name }}')">
          üö™ –í—ã–π—Ç–∏ –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
        </button>
    {% endif %}
  </div>
</div>

<div class="card bg-secondary text-white mb-4">
    <div class="card-body bg-white text-dark rounded">
        {% if library.owner_id == user.id %}
            <h6 class="card-title">‚úèÔ∏è –ò–∑–º–µ–Ω–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏</h6>
            <p class="card-text mb-0">–í–∞–º –¥–æ—Å—Ç—É–ø–Ω–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.</p>
            <p>–ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –≤—Å–µ –∫–Ω–∏–≥–∏ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –±—É–¥—É—Ç –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ —É–¥–∞–ª–µ–Ω—ã.</p>

            <form action="/library/{{ library.id }}/edit" method="post">
              <div class="mb-3">
                <label class="form-label text-dark"><strong>–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏</strong></label>
                <input type="text" name="new_name" class="form-control"  value="{{ library.name }}" required>
              </div>

              <div class="d-flex gap-2 justify-content-between">
                <button type="submit" class="btn btn-success">
                  üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                </button>
                <button type="button" class="btn btn-secondary" onclick="window.history.back()">
                  –û—Ç–º–µ–Ω–∞
                </button>
              </div>
            </form>

        {% else %}
            <h6 class="card-title">‚ÑπÔ∏è –î–æ—Å—Ç—É–ø –∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω</h6>
            <p class="card-text mb-0">
              –í–∞–º –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –≤—ã—Ö–æ–¥ –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.
            </p>
            <p class="card-text mb-0">
              –ß—Ç–æ–±—ã —Å–º–µ–Ω–∏—Ç—å –∏–º—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ - –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Å–æ–∑–¥–∞—Ç–µ–ª—é.
            </p><br>
            <p class="card-text mb-0">
              <strong>–°–æ–∑–¥–∞—Ç–µ–ª—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:</strong> {{ owner_username }}
            </p>
        {% endif %}
    </div>
</div>

<!-- ‚úÖ Modal –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤—ã—Ö–æ–¥–∞ –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ -->
<div class="modal fade" id="leaveLibraryModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content bg-dark text-center">
            <div class="modal-header border-0 pb-0">
                <h5 class="modal-title w-100">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞ –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body text-dark">
              <div class="alert alert-warning py-2">
                <div class="text-center fw-bold mb-1">–í—ã –ø–æ—Ç–µ—Ä—è–µ—Ç–µ –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º –∫–Ω–∏–≥–∞–º –≤ —ç—Ç–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–µ</div>
                <div class="text-center">
                  –í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏ –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏?
                  <div class="mt-2 p-2 bg-light rounded border">
                          <strong id="library-name-leave" class="text-dark">¬´–ù–∞–∑–≤–∞–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏¬ª</strong>
                  </div>
                </div>
              </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                <form id="leaveLibraryForm" method="post" style="display:inline;">
                    <button type="submit" class="btn btn-warning">üö™ –í—ã–π—Ç–∏ –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏</button>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- ‚úÖ Modal –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ -->
<div class="modal fade" id="deleteLibraryModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content bg-dark text-center">
            <div class="modal-header border-0 pb-0">
                <h5 class="modal-title w-100">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body text-dark">
              <div class="alert alert-danger py-2">
                <div class="text-center fw-bold mb-1">‚ö†Ô∏è –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!</div>
                <div class="text-center">
                  –í—Å–µ –∫–Ω–∏–≥–∏ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –±—É–¥—É—Ç –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ —É–¥–∞–ª–µ–Ω—ã.
                  <div class="mt-2 p-2 bg-light rounded border">
                    <strong id="library-name-delete" class="text-dark">¬´–ù–∞–∑–≤–∞–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏¬ª</strong>
                  </div>
                </div>
              </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                <form id="deleteLibraryForm" method="post" style="display:inline;">
                    <button type="submit" class="btn btn-danger">üóë –£–¥–∞–ª–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É</button>
                </form>
            </div>
        </div>
    </div>
</div>


<script>
function confirmDeleteLibrary(libraryId, libraryName) {
    document.getElementById('library-name-delete').textContent = libraryName;
    document.getElementById('deleteLibraryForm').action = `/library/${libraryId}/delete`;

    const modal = new bootstrap.Modal(document.getElementById('deleteLibraryModal'));
    modal.show();
}

function confirmLeaveLibrary(libraryId, libraryName) {
    document.getElementById('library-name-leave').textContent = libraryName;
    document.getElementById('leaveLibraryForm').action = `/library/${libraryId}/leave`;

    const modal = new bootstrap.Modal(document.getElementById('leaveLibraryModal'));
    modal.show();
}
</script>


{% endblock %}