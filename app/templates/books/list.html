{% extends 'base.html'%}

{% block crud_container %}
<!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –∫–Ω–æ–ø–∫–∏ -->
<div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mb-4">
  <h1 class="h3 mb-3 mb-md-0">üìö –í—Å–µ –∫–Ω–∏–≥–∏</h1>
  <div class="d-flex flex-wrap gap-2">
    <a href="/book/create" class="btn btn-success">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–∏–≥—É</a>
    <a href="/book/search" class="btn btn-outline-secondary">üîç –ü–æ–∏—Å–∫</a>
  </div>
</div>

{% if books_with_status %}
<!-- –¢–∞–±–ª–∏—Ü–∞ –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞ -->
<div class="d-none d-lg-block">
  <div class="table-responsive rounded-3" >
    <table class="table table-striped table-hover mb-0">
        <tr>
          <th>‚Ññ</th>
          <th>–ê–≤—Ç–æ—Ä</th>
          <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
          <th>–ñ–∞–Ω—Ä</th>
          <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
          <th>–°—Ç–∞—Ç—É—Å</th>
          <th>–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞</th>
        </tr>
        {% for item in books_with_status %}
        <tr>
          <td>{{ loop.index }}</td>
          <td>{{ item.book.author }}</td>
          <td><a href="/book/{{ item.book.id }}?back_url=/book/"
                class="text-decoration-none">{{ item.book.title }}</a></td>
          <td>{{ item.book.genre }}</td>
          <td>{{ item.book.description }}</td>
          <td>
            <span class="badge bg-{{ 'success' if item.read_status.value == 'read' else 'warning' if item.read_status.value == 'reading' else 'secondary' }}">
              {{ item.read_status.russian_name }}
            </span>
          </td>
          <td>{{ item.book.lib_address }}</td>
        </tr>
        {% endfor %}

    </table>
  </div>
</div>

<!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö -->
<div class="d-block d-lg-none">  <!-- ‚úÖ –¢–æ–ª—å–∫–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö -->
  {% for item in books_with_status %}
  <a href="/book/{{ item.book.id }}" class="text-decoration-none">
  <div class="card mb-3">
    <div class="card-body text-dark">
      <h5 class="card-title">{{ item.book.title }}</h5>
      <p class="card-text mb-1"><strong>–ê–≤—Ç–æ—Ä:</strong> {{ item.book.author }}</p>
      {% if item.book.genre %}
      <p class="card-text mb-1"><strong>–ñ–∞–Ω—Ä:</strong> {{ item.book.genre }}</p>
      {% endif %}
      {% if item.book.description %}
      <p class="card-text mb-2">
        <strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong>
        <small class="text-muted">{{ item.book.description|truncate(50) }}</small>
      </p>
      {% endif %}
      <p class="card-text mb-2">
        <span class="badge bg-{{ 'success' if item.read_status.value == 'read' else 'warning' if item.read_status.value == 'reading' else 'secondary' }}">
          {{ item.read_status.russian_name }}
        </span>
      </p>
      <small class="text-muted">ID: {{ item.book.id }} | –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞: {{ item.book.lib_address }}</small>
    </div>
  </div>
  </a>
  {% endfor %}
</div>

{% else %}
<!-- —Å–æ–æ–±—â–µ–Ω–∏–µ –µ—Å–ª–∏ –Ω–µ—Ç –∫–Ω–∏–≥ -->
<div class="alert alert-light border text-center py-5">
  <h4 class="alert-heading">üìö –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∫–Ω–∏–≥</h4>
  <p class="mb-3">–î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ—é –ø–µ—Ä–≤—É—é –∫–Ω–∏–≥—É –∏–ª–∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç–µ—Å—å –∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ!</p>
  <div class="mt-3">
    <a href="/book/create" class="btn btn-success">–î–æ–±–∞–≤–∏—Ç—å –∫–Ω–∏–≥—É</a>
    <a href="/library/join" class="btn btn-outline-secondary">–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ</a>
  </div>
</div>
{% endif %}
{% endblock %}